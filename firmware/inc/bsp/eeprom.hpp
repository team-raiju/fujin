#pragma once

#include <cstdint>

namespace bsp::eeprom {

/// @section Custom types

enum EepromResult {
    OK,
    ERROR,
    DATA_NOT_FOUND,
};

typedef enum : uint16_t {
    ADDR_MEMORY_CLEAR = 0x0000,

    // PARAMS 0x0004 ~ 0x0FFF
    ADDR_FAN_SPEED = 0x0004,
    ADDR_ANGULAR_KP = 0x0008,
    ADDR_ANGULAR_KI = 0x000C,
    ADDR_ANGULAR_KD = 0x0010,
    ADDR_WALL_KP = 0x0014,
    ADDR_WALL_KI = 0x0018,
    ADDR_WALL_KD = 0x001C,
    ADDR_LINEAR_VEL_KP = 0x0020,
    ADDR_LINEAR_VEL_KI = 0x0024,
    ADDR_LINEAR_VEL_KD = 0x0028,
    ADDR_DIAGONAL_WALLS_KP = 0x002C,
    ADDR_DIAGONAL_WALLS_KI = 0x0030,
    ADDR_DIAGONAL_WALLS_KD = 0x0034,
    ADDR_MIN_MOVE_SPEED = 0x0038,

    ADDR_IR_WALL_DIST_REF_RIGHT = 0x003C,
    ADDR_IR_WALL_DIST_REF_FRONT_LEFT = 0x0040,
    ADDR_IR_WALL_DIST_REF_FRONT_RIGHT = 0x0044,
    ADDR_IR_WALL_DIST_REF_LEFT = 0x0048,
    ADDR_IR_WALL_CONTROL_TH_RIGHT = 0x004C,
    ADDR_IR_WALL_CONTROL_TH_FRONT_LEFT = 0x0050,
    ADDR_IR_WALL_CONTROL_TH_FRONT_RIGHT = 0x0054,
    ADDR_IR_WALL_CONTROL_TH_LEFT = 0x0058,
    ADDR_IR_WALL_DETECT_TH_RIGHT = 0x005C,
    ADDR_IR_WALL_DETECT_TH_FRONT_LEFT = 0x0060,
    ADDR_IR_WALL_DETECT_TH_FRONT_RIGHT = 0x0064,
    ADDR_IR_WALL_DETECT_TH_LEFT = 0x0068,

    ADDR_Z_IMU_BIAS = 0x006C,

    // MAZE 0x1000 ~ 0x13FF
    ADDR_MAZE_START = 0x1000,

    // FOWARD PARAMS 0x1400 ~ 0x1500
    ADDR_FORWARD_PARAMS_START = 0x1400,
    ADDR_FORWARD_PARAMS_FOWARD = 0x1410,
    ADDR_FORWARD_PARAMS_DIAGONAL = 0x1420,
    ADDR_FORWARD_PARAMS_STOP = 0x1430,
    ADDR_FORWARD_PARAMS_TURN_AROUND = 0x1440,
    ADDR_FORWARD_PARAMS_RIGHT_45_FROM_45 = 0x1450,
    ADDR_FORWARD_PARAMS_LEFT_45_FROM_45 = 0x1460,
    ADDR_FORWARD_PARAMS_RIGHT_90_FROM_45 = 0x1470,
    ADDR_FORWARD_PARAMS_LEFT_90_FROM_45 = 0x1480,
    ADDR_FORWARD_PARAMS_RIGHT_135_FROM_45 = 0x1490,
    ADDR_FORWARD_PARAMS_LEFT_135_FROM_45 = 0x14A0,
    ADDR_FORWARD_PARAMS_TURN_AROUND_INPLACE = 0x14B0,

    // TURN PARAMS 0x1500 ~ 0x1800
    ADDR_TURN_PARAMS_RIGHT_45 = 0x1500,
    ADDR_TURN_PARAMS_LEFT_45 = 0x1520,
    ADDR_TURN_PARAMS_RIGHT_90 = 0x1540,
    ADDR_TURN_PARAMS_LEFT_90 = 0x1560,
    ADDR_TURN_PARAMS_RIGHT_135 = 0x1580,
    ADDR_TURN_PARAMS_LEFT_135 = 0x15A0,
    ADDR_TURN_PARAMS_RIGHT_180 = 0x15C0,
    ADDR_TURN_PARAMS_LEFT_180 = 0x15E0,
    ADDR_TURN_PARAMS_RIGHT_45_FROM_45 = 0x1600,
    ADDR_TURN_PARAMS_LEFT_45_FROM_45 = 0x1620,
    ADDR_TURN_PARAMS_RIGHT_90_FROM_45 = 0x1640,
    ADDR_TURN_PARAMS_LEFT_90_FROM_45 = 0x1660,
    ADDR_TURN_PARAMS_RIGHT_135_FROM_45 = 0x1680,
    ADDR_TURN_PARAMS_LEFT_135_FROM_45 = 0x16A0,
    ADDR_TURN_PARAMS_TURN_AROUND = 0x16C0,
    ADDR_TURN_PARAMS_RIGHT_90_SEARCH_MODE = 0x16E0,
    ADDR_TURN_PARAMS_LEFT_90_SEARCH_MODE = 0x1700,
    ADDR_TURN_PARAMS_TURN_AROUND_INPLACE = 0x1720,

    // MOVE SEQUENCE 0x1800 ~ 0x1900
    ADDR_MOVE_SEQUENCE_1 = 0x1800,
    ADDR_MOVE_SEQUENCE_2 = 0x1801,
    ADDR_MOVE_SEQUENCE_3 = 0x1802,
    ADDR_MOVE_SEQUENCE_4 = 0x1803,
    ADDR_MOVE_SEQUENCE_5 = 0x1804,
    ADDR_MOVE_SEQUENCE_6 = 0x1805,
    ADDR_MOVE_SEQUENCE_7 = 0x1806,
    ADDR_MOVE_SEQUENCE_8 = 0x1807,
    ADDR_MOVE_SEQUENCE_9 = 0x1808,
    ADDR_MOVE_SEQUENCE_10 = 0x1809,
    ADDR_MOVE_SEQUENCE_11 = 0x180A,
    ADDR_MOVE_SEQUENCE_12 = 0x180B,
    ADDR_MOVE_SEQUENCE_13 = 0x180C,
    ADDR_MOVE_SEQUENCE_14 = 0x180D,
    ADDR_MOVE_SEQUENCE_15 = 0x180E,
    ADDR_MOVE_SEQUENCE_16 = 0x180F,
    ADDR_MOVE_SEQUENCE_17 = 0x1810,
    ADDR_MOVE_SEQUENCE_18 = 0x1811,

    ADDR_MAX = 0xFFFF,
} param_addresses_t;

struct ParamInfo {
    uint16_t address;
    const char* name;
};

// Initialize the array with address-name pairs
const ParamInfo paramInfoArray[] = {
    {ADDR_MEMORY_CLEAR, "ADDR_MEMORY_CLEAR"},
    {ADDR_FAN_SPEED, "ADDR_FAN_SPEED"},
    {ADDR_ANGULAR_KP, "ADDR_ANGULAR_KP"},
    {ADDR_ANGULAR_KI, "ADDR_ANGULAR_KI"},
    {ADDR_ANGULAR_KD, "ADDR_ANGULAR_KD"},
    {ADDR_WALL_KP, "ADDR_WALL_KP"},
    {ADDR_WALL_KI, "ADDR_WALL_KI"},
    {ADDR_WALL_KD, "ADDR_WALL_KD"},
    {ADDR_LINEAR_VEL_KP, "ADDR_LINEAR_VEL_KP"},
    {ADDR_LINEAR_VEL_KI, "ADDR_LINEAR_VEL_KI"},
    {ADDR_LINEAR_VEL_KD, "ADDR_LINEAR_VEL_KD"},
    {ADDR_DIAGONAL_WALLS_KP, "ADDR_DIAGONAL_WALLS_KP"},
    {ADDR_DIAGONAL_WALLS_KI, "ADDR_DIAGONAL_WALLS_KI"},
    {ADDR_DIAGONAL_WALLS_KD, "ADDR_DIAGONAL_WALLS_KD"},
    {ADDR_MIN_MOVE_SPEED, "ADDR_MIN_MOVE_SPEED"},
    {ADDR_Z_IMU_BIAS, "ADDR_Z_IMU_BIAS"},
};

/// @section Interface definition

EepromResult init(void);

EepromResult read_u8(uint16_t address, uint8_t* data);
EepromResult write_u8(uint16_t address, uint8_t data);
EepromResult read_u16(uint16_t address, uint16_t* data);
EepromResult write_u16(uint16_t address, uint16_t data);
EepromResult read_u32(uint16_t address, uint32_t* data);
EepromResult read_array(uint16_t address, uint8_t* data, uint16_t size);
EepromResult write_u32(uint16_t address, uint32_t data);
EepromResult write_array(uint16_t address, uint8_t* data, uint16_t size);

void clear(void);
void print_all(void);
const char* param_name(uint16_t address);

}
